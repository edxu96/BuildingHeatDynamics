---
title: "Q2-3: Base Splines"
output: html_notebook
---

Try to vary the degrees of freedom (df). What happens to the base splines gener- ated?

Try to vary the degree (degree). What happens to the base splines generated?

Give the knot points directly (using the knots argument). Give the knots as the quantiles of x, what happens when degree = 1 and what happens when degree = 3? (exactly how the base splines are generated when degree > 1 is left out of scope of the exercise, just think about that it is done using some "optimal" procedure).

Try with some non-equidistant x sequence, such that the quantiles are not equidis- tant. What happens with the base splines?

# Q3

```{r}
rm(list = ls())
source("data.R")
source("~/GitHub/TSA-Energy/src/NonPara.R")
df_x <- get_data()
plot(df_x$Te)
```

```{r}
df <- 7
temp_ext_bs <- bs(df_x$Te, df = df, degree = 3, intercept = TRUE)[ , ]
plot_bs(df_x$Te, temp_ext_bs)
knots <- quantile(df_x$Te, probs = seq(0, 1, by = 1 / (df - 1)))
abline(v = knots)
```

```{r}
setwd("~/GitHub/TSA-Energy/files/ex_1/r")
rm(ls = list())

require(splines)
df_x <- readRDS("soenderborg_2day.RDS")

fit_bs <- function(datf, df, whe_intercept){
    if (whe_intercept) {
        lm <- lm(P ~ 0 + bs(Te, df=4, intercept=TRUE), df_x)
    }
    else {
        lm <- lm(P ~ bs(Te, df = df), datf)
    }
    seq_x <- seq(min(df_x$Te), max(df_x$Te), len = 100)
    seq_y <- predict(lm, newdata = data.frame(Te = seq_x))
    plot(df_x$Te, df_x$P)
    ## We need to use predict to see the estimated function
    lines(seq_x, seq_y, col = 2)
    return(lm)
}

fit_bs(datf = df_x, df = 3, whe_intercept = FALSE)
fit_bs(datf = df_x, df = 10, whe_intercept = FALSE)
fit_bs(datf = df_x, df = 3, whe_intercept = TRUE)
fit_bs(datf = df_x, df = 10, whe_intercept = TRUE)



```




